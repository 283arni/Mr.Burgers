!function(){class e{constructor(e,t){this.container=document.querySelector(e),this.items=this.container.querySelectorAll("li"),this.addActive(this.items,t)}addActive(e,t){Array.from(e).forEach(n=>{n.addEventListener("click",()=>{const o=n.querySelector(".accordeon__visible");n.classList.contains("active")?(this.removeActive(e,t),o.style.cssText=`${t}: 0`):(this.removeActive(e,t),n.classList.add("active"),o.style.cssText=`${t}: 100%`)})})}removeActive(e,t){Array.from(e).forEach(e=>{const n=e.querySelector(".accordeon__visible");e.classList.remove("active"),n.style.cssText=`${t}: 0`})}}new e(".accordeon","height"),new e(".accordeon_menu","width")}(),function(){const e=$(".hero__svg");var t=e.offset().left,n=e.offset().top;document.body.clientWidth>768&&$(".hero").mousemove(function(o){var c=o.pageY;!function(o,c){var i=(o-t)/100+"px",r=(c-n)/50+"px";e.css({left:i,top:r})}(o.pageX,c)})}(),ymaps.ready(init);var myPlacemarks=[{coords:59.938433,coords2:30.306681,hint:"Бургеры на Адмиралтейской набережной, 10"},{coords:59.966402,coords2:30.311461,hint:"Бургеры на Каменноостровском проспекте, 37"},{coords:59.946715,coords2:30.434368,hint:"Бургеры на проспекте Энергетиков, 16"}];function init(){var e=new ymaps.Map("map",{center:[59.939095,30.315868],zoom:12,controls:["geolocationControl","zoomControl","searchControl"]});e.behaviors.disable("scrollZoom"),myPlacemarks.forEach(function(t){var n=new ymaps.Placemark([t.coords,t.coords2],{hintContent:t.hint},{iconLayout:"default#image",iconImageHref:"/images/contacts/map-marker.svg",iconImageSize:[46,57]});e.geoObjects.add(n)})}!function(){const e=document.querySelector(".nav__little"),t=document.querySelector(".hamburger"),n=document.querySelector(".hamburger .close__link");e.addEventListener("click",function(e){e.preventDefault(),t.style.display="flex"}),n.addEventListener("click",function(e){e.preventDefault(),t.style.display="none"}),t.addEventListener("click",function(e){e.target===t&&n.click()}),$("[data-skroll]").on("click",function(e){t.style.display="none"})}(),function(){const e=document.querySelector("#modal-popup").innerHTML,t=document.querySelectorAll(".btn_phone"),n=document.querySelectorAll(".btn_none"),o=document.querySelector(".comments__story");for(i=0;i<t.length;i++)t[i].addEventListener("click",e=>{e.preventDefault();const t=c(o.innerHTML);document.body.appendChild(t)});for(i=0;i<n.length;i++)n[i].addEventListener("click",e=>{e.preventDefault();const t=c(o.innerHTML);document.body.appendChild(t)});function c(t){const n=document.createElement("div");n.classList.add("popup"),n.innerHTML=e,n.querySelector(".popup__message").innerHTML=t;const o=n.querySelector(".close__popup .close__link");return o.addEventListener("click",e=>{e.preventDefault(),document.body.removeChild(n)}),n.addEventListener("click",e=>{e.target===n&&o.click()}),n}const r=/^((8|\+7)[\- ]?)?(\(?\d{3}\)?[\-]?)?[\d\- ]{7,10}$/,s=/^[а-яА-Я]{2,30}|[a-zA-Z]{2,30}$/,l=/^[А-Яа-я0-9\ \.,!\?\-@]+$/,a=document.querySelector("#form"),d=document.querySelector("#sendBtn");function u(e,t){e.nextElementSibling.style.display="block",e.nextElementSibling.textContent=t}function m(e){e.nextElementSibling.style.display="none"}function v(e){if(s.test(a.name.value))m(a.name);else{const t="Введите адекватное имя. Пример: Степан, Billy, Иоган.";u(a.name,t),e=!1}if(r.test(a.phone.value))m(a.phone);else{const t="Введите верный номер телефона. Пример: +7 123 456 78 90, 1234567890.";u(a.phone,t),e=!1}if(l.test(a.comment.value))m(a.comment);else{const t="Введите комментарий. Не больше 150 символов. Разрешено только кириллица, символы ! , . ? - @.";u(a.comment,t),e=!1}return e}a.addEventListener("keydown",()=>{v(!0)}),a.addEventListener("submit",t=>{if(t.preventDefault(),v(!0),v(!0)){const t=new FormData(a);t.append("to","mail@mail.com");const n=new XMLHttpRequest;n.open("POST","https://webdev-api.loftschool.com/sendmail"),n.send(t),n.addEventListener("load",()=>{const t=function(t){const n=document.createElement("div"),o=document.createElement("input");return n.classList.add("popup"),n.innerHTML=e,n.querySelector(".popup__message").innerHTML=t,n.firstElementChild.firstElementChild.remove(),o.classList.add("btn","btn_modal"),o.type="submit",o.value="Закрыть",n.firstElementChild.appendChild(o),n}(JSON.parse(n.responseText).message);n.status>=400?document.body.appendChild("Что-то сломалось..."):(document.body.appendChild(t),function(e){document.querySelector(".btn_modal").addEventListener("click",t=>{t.preventDefault(),document.body.removeChild(e)})}(t))})}d.disabled=!0,setTimeout(()=>{d.disabled=!1},3e3)})}(),$(document).ready(function(){var e=$(".wrapper"),t=$(".section"),n=$(".maincontainer");function o(e){$(".nav-sections__circle").removeClass("active").eq(e).addClass("active")}function c(e){1==e||6==e||8==e?($(".nav-sections__point").css("background-color","#2f3234"),$(".nav-sections__circle").css("border-color","transparent"),$(".nav-sections__circle.active").css("border-color","#2f3234")):($(".nav-sections__point").css("background-color","#fff"),$(".nav-sections__circle").css("border-color","transparent"),$(".nav-sections__circle.active").css("border-color","#fff"))}function i(){const e=document.querySelector(".up");document.body.clientWidth<480&&(u.classList.contains("active")?(a.call(document),e.style.display="none"):(l.call(document.body),e.style.display="block"))}var r=!1;function s(e,t){let n=$(".nav-sections__circle").filter(".active");40!=e&&"up"!=t||n.next().click(),38!=e&&"down"!=t||n.prev().click()}e.on("wheel",function(e){e.preventDefault();var i,s=t.filter(".active"),l=s.next(),a=s.prev();function d(e,t){n.animate({bottom:100*e+"vh"},700,function(){s.removeClass("active"),c(e)})}!1===r&&(r=!0,e.originalEvent.deltaY>0?(l.length?(i=l.index(),l.addClass("active")):(i=t.first().index(),t.first().addClass("active")),d(i),o(i)):(a.length?(i=a.index(),a.addClass("active")):(i=t.last().index(),t.last().addClass("active")),d(i),o(i)),setTimeout(()=>{r=!1},1500))}),$("[data-skroll]").on("click",function(e){e.preventDefault();const r=$(this).attr("data-skroll");var s;t.removeClass("active"),$(".section").eq(r).addClass("active"),s=r,n.animate({bottom:100*s+"vh"},700,function(){}),o(r),c(r),i()});var l=document.body.requestFullscreen||document.body.mozRequestFullScreen||document.body.webkitRequestFullScreen||document.body.msRequestFullscreen,a=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen;const d=new MobileDetect(window.navigator.userAgent).mobile(),u=document.querySelector(".hero");d&&$(".maincontainer").swipe({swipe:function(e,t){s("",t),i()}}),$(document).on("keydown",e=>{switch(e.keyCode){case 40:case 38:e.preventDefault(),s(e.keyCode)}})});const containerVideo=document.querySelector(".video__player"),video=document.querySelector(".video__burger"),player=document.querySelector(".video__controls"),play=document.querySelector(".video__start"),trackDot=document.querySelector(".video__track-dot"),track=document.querySelector(".video__line"),volume=document.querySelector(".video__volume"),volumeTrack=document.querySelector(".video__volume-line"),volumeDot=document.querySelector(".video__volume-dot"),playScreen=document.querySelector(".video__play-screen");function defaultVolume(){const e=video.volume=.2;volumeDot.style.left=Math.floor(e*volumeTrack.clientWidth)+"px"}function playPause(){video.paused?video.play():video.pause(),containerVideo.classList.toggle("pause")}function timeUpdate(){const e=Math.floor(video.currentTime)/Math.floor(video.duration);trackDot.style.left=`${Math.floor(e*track.clientWidth)}px`}function setCurrentTime(e){const t=e.offsetX/track.clientWidth;video.currentTime=t*video.duration}function muted(e){e.currentTarget.classList.toggle("mute"),video.muted=!video.muted}function setVolume(e){volumeDot.style.left=`${e.offsetX}px`,video.volume=e.offsetX/e.currentTarget.clientWidth,0===video.volume?volume.classList.add("mute"):volume.classList.remove("mute")}video.addEventListener("canplaythrough",function(){defaultVolume()}),play.addEventListener("click",function(){playPause()}),playScreen.addEventListener("click",function(){playPause()}),video.addEventListener("timeupdate",function(){timeUpdate()}),track.addEventListener("click",function(e){setCurrentTime(e)}),volume.addEventListener("click",function(e){muted(e)}),volumeTrack.addEventListener("click",function(e){setVolume(e)}),function(){new class{constructor(e){this.container=document.querySelector(e),this.slider=this.container.querySelector(".slider__list"),this.item=this.slider.querySelectorAll(".slider__slid"),this.btnLeft=this.container.querySelector(".slider__btn_prev"),this.btnRight=this.container.querySelector(".slider__btn_next"),this.currentItem=0,this.btnLeft.addEventListener("click",e=>{e.preventDefault(),this.sliderGo("prev")}),this.btnRight.addEventListener("click",e=>{e.preventDefault(),this.sliderGo("next")})}sliderGo(e){"next"===e&&this.currentItem++,"prev"===e&&this.currentItem--,this.currentItem===this.item.length&&(this.currentItem=0),this.currentItem<0&&(this.currentItem=this.item.length-1),this.translate()}translate(){this.slider.style.transform=`translateX(-${this.currentItem}00%)`}}(".slider")}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjY29yZGVvbi5qcyIsImRyb3BzLmpzIiwibWFwLmpzIiwibWVudVBob25lLmpzIiwibW9kYWwuanMiLCJvbmVwYWdlc2Nyb2xsLmpzIiwicGxheWVyLmpzIiwic2xpZGVyLmpzIl0sIm5hbWVzIjpbIkFjY29yZGVvbiIsIltvYmplY3QgT2JqZWN0XSIsInNlY3Rpb24iLCJzaXplIiwidGhpcyIsImNvbnRhaW5lciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIml0ZW1zIiwicXVlcnlTZWxlY3RvckFsbCIsImFkZEFjdGl2ZSIsIm9iaiIsIkFycmF5IiwiZnJvbSIsImZvckVhY2giLCJpdGVtIiwiYWRkRXZlbnRMaXN0ZW5lciIsImluZm8iLCJjbGFzc0xpc3QiLCJjb250YWlucyIsInJlbW92ZUFjdGl2ZSIsInN0eWxlIiwiY3NzVGV4dCIsImFkZCIsInBpcCIsInJlbW92ZSIsImRyb3BzIiwiJCIsInBvc1giLCJvZmZzZXQiLCJsZWZ0IiwicG9zWSIsInRvcCIsImJvZHkiLCJjbGllbnRXaWR0aCIsIm1vdXNlbW92ZSIsImUiLCJtb3ZlWSIsInBhZ2VZIiwibW92ZVgiLCJjb3Jkc1giLCJjb3Jkc1kiLCJjc3MiLCJtb3ZlRHJvcHMiLCJwYWdlWCIsInltYXBzIiwicmVhZHkiLCJpbml0IiwibXlQbGFjZW1hcmtzIiwiY29vcmRzIiwiY29vcmRzMiIsImhpbnQiLCJteU1hcCIsIk1hcCIsImNlbnRlciIsInpvb20iLCJjb250cm9scyIsImJlaGF2aW9ycyIsImRpc2FibGUiLCJteVBsYWNlbWFyayIsIlBsYWNlbWFyayIsImhpbnRDb250ZW50IiwiaWNvbkxheW91dCIsImljb25JbWFnZUhyZWYiLCJpY29uSW1hZ2VTaXplIiwiZ2VvT2JqZWN0cyIsIm1lbnUiLCJmdWxsTWVudSIsImNsb3NlTWVudSIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJkaXNwbGF5IiwidGFyZ2V0IiwiY2xpY2siLCJvbiIsIm1vZGFsIiwiaW5uZXJIVE1MIiwiYnRuUmVhZCIsImJ0blJlYWQyIiwiY29tbWVudCIsImkiLCJsZW5ndGgiLCJibG9jayIsImNyZWF0ZUJsb2NrIiwiYXBwZW5kQ2hpbGQiLCJ0ZXh0IiwiZGl2IiwiY3JlYXRlRWxlbWVudCIsImJ0bkNsb3NlIiwicmVtb3ZlQ2hpbGQiLCJ2YWxpZFRlbCIsInZhbGlkTmFtZSIsInZhbGlkQ29tbWVudCIsImlzRm9ybSIsInNlbmRCdG4iLCJjcmVhdGVFcnJvciIsIm5laWdoYm9yIiwibWVzc2FnZSIsIm5leHRFbGVtZW50U2libGluZyIsInRleHRDb250ZW50IiwicmVtb3ZlRXJyb3IiLCJ2YWxpZGF0ZUZvcm0iLCJ2YWxpZCIsInRlc3QiLCJuYW1lIiwidmFsdWUiLCJlcnJvcmVOYW1lIiwicGhvbmUiLCJlcnJvcmVQaG9uZSIsImZvcm0iLCJGb3JtRGF0YSIsImFwcGVuZCIsInhociIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsInNlbmQiLCJkaXZGb3JtIiwiaW5wdXQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsInR5cGUiLCJjcmVhdGVNb2RhbCIsIkpTT04iLCJwYXJzZSIsInJlc3BvbnNlVGV4dCIsInN0YXR1cyIsImVsZW0iLCJkZWxldGVNb2R1bCIsImRpc2FibGVkIiwic2V0VGltZW91dCIsImNvbnRhaW5lclNjcm9sbCIsInNsaWRlckNvbnRhaW5lciIsImFjdGl2ZURvdCIsImluZGV4IiwicmVtb3ZlQ2xhc3MiLCJlcSIsImFkZENsYXNzIiwiY29sb3JEb3QiLCJpbmRleFNlY3Rpb24iLCJmdWxsU2NyZWVuIiwiZGl2VXAiLCJzZWN0aW9uSGVybyIsImNhbmNlbEZ1bGxTY3JlZW4iLCJjYWxsIiwicmVxdWVzdEZ1bGxTY3JlZW4iLCJpbnNjcm9sbCIsInRvdWNoQW5kS2V5Iiwia2V5Q29kZSIsImRpcmVjdGlvbiIsImltaXRhdGlvbkNsaWNrIiwiZmlsdGVyIiwibmV4dCIsInByZXYiLCJzZWN0aW9uQWN0IiwibmV4dFNlY3Rpb24iLCJwcmV2U2VjdGlvbiIsInNjcm9sbFdoZWVsIiwicG9zU2VjdGlvbiIsImFuaW1hdGUiLCJib3R0b20iLCJvcmlnaW5hbEV2ZW50IiwiZGVsdGFZIiwiZmlyc3QiLCJsYXN0IiwiaW5kZXhMaW5rIiwiYXR0ciIsInJlcXVlc3RGdWxsc2NyZWVuIiwibW96UmVxdWVzdEZ1bGxTY3JlZW4iLCJ3ZWJraXRSZXF1ZXN0RnVsbFNjcmVlbiIsIm1zUmVxdWVzdEZ1bGxzY3JlZW4iLCJleGl0RnVsbHNjcmVlbiIsIm1vekNhbmNlbEZ1bGxTY3JlZW4iLCJ3ZWJraXRFeGl0RnVsbHNjcmVlbiIsIm1zRXhpdEZ1bGxzY3JlZW4iLCJpc01vYmlsZSIsIk1vYmlsZURldGVjdCIsIndpbmRvdyIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsIm1vYmlsZSIsInN3aXBlIiwiY29udGFpbmVyVmlkZW8iLCJ2aWRlbyIsInBsYXllciIsInBsYXkiLCJ0cmFja0RvdCIsInRyYWNrIiwidm9sdW1lIiwidm9sdW1lVHJhY2siLCJ2b2x1bWVEb3QiLCJwbGF5U2NyZWVuIiwiZGVmYXVsdFZvbHVtZSIsInZvbCIsIk1hdGgiLCJmbG9vciIsInBsYXlQYXVzZSIsInBhdXNlIiwidG9nZ2xlIiwidGltZVVwZGF0ZSIsInByb2dyZXNzIiwiY3VycmVudFRpbWUiLCJkdXJhdGlvbiIsInNldEN1cnJlbnRUaW1lIiwieCIsIm9mZnNldFgiLCJtdXRlZCIsImN1cnJlbnRUYXJnZXQiLCJzZXRWb2x1bWUiLCJzZWxlY3RvciIsInNsaWRlciIsImJ0bkxlZnQiLCJidG5SaWdodCIsImN1cnJlbnRJdGVtIiwic2xpZGVyR28iLCJ3YXkiLCJ0cmFuc2xhdGUiLCJ0cmFuc2Zvcm0iXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0EsTUFBQUEsRUFDQUMsWUFBQUMsRUFBQUMsR0FDQUMsS0FBQUMsVUFBQUMsU0FBQUMsY0FBQUwsR0FDQUUsS0FBQUksTUFBQUosS0FBQUMsVUFBQUksaUJBQUEsTUFDQUwsS0FBQU0sVUFBQU4sS0FBQUksTUFBQUwsR0FHQUYsVUFBQVUsRUFBQVIsR0FDQVMsTUFBQUMsS0FBQUYsR0FB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LEtBQUFXLEtBQUFrRSxTQUNBN0UsS0FBQStNLFlBQUEsR0FHQS9NLEtBQUErTSxZQUFBLElBQ0EvTSxLQUFBK00sWUFBQS9NLEtBQUFXLEtBQUFrRSxPQUFBLEdBR0E3RSxLQUFBa04sWUFHQXJOLFlBQ0FHLEtBQUE0TSxPQUFBM0wsTUFBQWtNLHlCQUFBbk4sS0FBQStNLG9CQUlBLFdBaERBIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcclxuICBjbGFzcyBBY2NvcmRlb24ge1xyXG4gICAgY29uc3RydWN0b3Ioc2VjdGlvbiwgc2l6ZSkge1xyXG4gICAgICB0aGlzLmNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VjdGlvbik7XHJcbiAgICAgIHRoaXMuaXRlbXMgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCdsaScpO1xyXG4gICAgICB0aGlzLmFkZEFjdGl2ZSh0aGlzLml0ZW1zLCBzaXplKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgYWRkQWN0aXZlKG9iaiwgc2l6ZSkge1xyXG4gICAgICBBcnJheS5mcm9tKG9iaikuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+e1xyXG4gICAgICAgICAgY29uc3QgaW5mbyA9IGl0ZW0ucXVlcnlTZWxlY3RvcignLmFjY29yZGVvbl9fdmlzaWJsZScpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBpZighaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQWN0aXZlKG9iaiwgc2l6ZSk7XHJcbiAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIGluZm8uc3R5bGUuY3NzVGV4dCA9IGAke3NpemV9OiAxMDAlYDtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQWN0aXZlKG9iaiwgc2l6ZSk7XHJcbiAgICAgICAgICAgIGluZm8uc3R5bGUuY3NzVGV4dCA9IGAke3NpemV9OiAwYDtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlQWN0aXZlKG9iaiwgcGlwKSB7XHJcbiAgICAgIEFycmF5LmZyb20ob2JqKS5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgICAgY29uc3QgaW5mbyA9IGl0ZW0ucXVlcnlTZWxlY3RvcignLmFjY29yZGVvbl9fdmlzaWJsZScpO1xyXG5cclxuICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpO1xyXG4gICAgICAgIGluZm8uc3R5bGUuY3NzVGV4dCA9IGAke3BpcH06IDBgO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG5ldyBBY2NvcmRlb24oJy5hY2NvcmRlb24nLCAnaGVpZ2h0Jyk7XHJcbiAgbmV3IEFjY29yZGVvbignLmFjY29yZGVvbl9tZW51JywgJ3dpZHRoJyk7XHJcblxyXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XHJcbiAgY29uc3QgZHJvcHMgPSAkKCcuaGVyb19fc3ZnJyk7XHJcblxyXG4gIHZhciBwb3NYID0gZHJvcHMub2Zmc2V0KCkubGVmdDtcclxuICB2YXIgcG9zWSA9IGRyb3BzLm9mZnNldCgpLnRvcDtcclxuXHJcbiAgZnVuY3Rpb24gbW92ZURyb3BzKG1vdmVYLCBtb3ZlWSkge1xyXG4gICAgdmFyIGNvcmRzWCA9IChtb3ZlWCAtIHBvc1gpIC8gMTAwICsgJ3B4JztcclxuICAgIHZhciBjb3Jkc1kgPSAobW92ZVkgLSBwb3NZKSAvIDUwICsgJ3B4JztcclxuICAgIGRyb3BzLmNzcyh7XHJcbiAgICAgIGxlZnQ6IGNvcmRzWCxcclxuICAgICAgdG9wOiBjb3Jkc1lcclxuICAgIH0pXHJcbiAgfVxyXG5cclxuICBpZiAoZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aCA+IDc2OCkge1xyXG4gICAgJCgnLmhlcm8nKS5tb3VzZW1vdmUoZnVuY3Rpb24gKGUpIHtcclxuICAgICAgdmFyIG1vdmVZID0gZS5wYWdlWTtcclxuICAgICAgdmFyIG1vdmVYID0gZS5wYWdlWDtcclxuICAgICAgbW92ZURyb3BzKG1vdmVYLCBtb3ZlWSk7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcblxyXG59KSgpOyIsInltYXBzLnJlYWR5KGluaXQpO1xyXG5cclxudmFyIG15UGxhY2VtYXJrcyA9IFt7XHJcbiAgICBjb29yZHM6IDU5LjkzODQzMyxcclxuICAgIGNvb3JkczI6IDMwLjMwNjY4MSxcclxuICAgIGhpbnQ6IFwi0JHRg9GA0LPQtdGA0Ysg0L3QsCDQkNC00LzQuNGA0LDQu9GC0LXQudGB0LrQvtC5INC90LDQsdC10YDQtdC20L3QvtC5LCAxMFwiXHJcbiAgfSxcclxuICB7XHJcbiAgICBjb29yZHM6IDU5Ljk2NjQwMixcclxuICAgIGNvb3JkczI6IDMwLjMxMTQ2MSxcclxuICAgIGhpbnQ6IFwi0JHRg9GA0LPQtdGA0Ysg0L3QsCDQmtCw0LzQtdC90L3QvtC+0YHRgtGA0L7QstGB0LrQvtC8INC/0YDQvtGB0L/QtdC60YLQtSwgMzdcIlxyXG4gIH0sXHJcbiAge1xyXG4gICAgY29vcmRzOiA1OS45NDY3MTUsIFxyXG4gICAgY29vcmRzMjogMzAuNDM0MzY4LFxyXG4gICAgaGludDogXCLQkdGD0YDQs9C10YDRiyDQvdCwINC/0YDQvtGB0L/QtdC60YLQtSDQrdC90LXRgNCz0LXRgtC40LrQvtCyLCAxNlwiXHJcbiAgfVxyXG5dXHJcblxyXG5mdW5jdGlvbiBpbml0KCkge1xyXG4gIHZhciBteU1hcCA9IG5ldyB5bWFwcy5NYXAoXCJtYXBcIiwge1xyXG4gICAgY2VudGVyOiBbNTkuOTM5MDk1LCAzMC4zMTU4NjhdLFxyXG4gICAgem9vbTogMTIsXHJcbiAgICBjb250cm9sczogWydnZW9sb2NhdGlvbkNvbnRyb2wnLCd6b29tQ29udHJvbCcsJ3NlYXJjaENvbnRyb2wnXVxyXG4gIH0pO1xyXG4gIG15TWFwLmJlaGF2aW9ycy5kaXNhYmxlKCdzY3JvbGxab29tJyk7IFxyXG4gIG15UGxhY2VtYXJrcy5mb3JFYWNoKGZ1bmN0aW9uIChvYmopIHtcclxuICAgIHZhciBteVBsYWNlbWFyayA9IG5ldyB5bWFwcy5QbGFjZW1hcmsoW29iai5jb29yZHMsIG9iai5jb29yZHMyXSwge1xyXG4gICAgICBoaW50Q29udGVudDogb2JqLmhpbnRcclxuICAgIH0sIHtcclxuICAgICAgaWNvbkxheW91dDogJ2RlZmF1bHQjaW1hZ2UnLFxyXG4gICAgICBpY29uSW1hZ2VIcmVmOiAnL2ltYWdlcy9jb250YWN0cy9tYXAtbWFya2VyLnN2ZycsXHJcbiAgICAgIGljb25JbWFnZVNpemU6IFs0NiwgNTddXHJcbiAgICB9KTtcclxuICAgIG15TWFwLmdlb09iamVjdHNcclxuICAgICAgLmFkZChteVBsYWNlbWFyayk7XHJcbiAgfSlcclxufSIsIihmdW5jdGlvbigpe1xyXG4gIC8vIG9wZW5lZCBtZW51IGZvciBwaG9uZVxyXG4gIGNvbnN0IG1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmF2X19saXR0bGUnKTtcclxuICBjb25zdCBmdWxsTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oYW1idXJnZXInKTtcclxuICBjb25zdCBjbG9zZU1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGFtYnVyZ2VyIC5jbG9zZV9fbGluaycpO1xyXG5cclxuICBtZW51LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgZnVsbE1lbnUuc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcclxuICB9KTtcclxuXHJcbiAgY2xvc2VNZW51LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgZnVsbE1lbnUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICB9KTtcclxuXHJcbiAgZnVsbE1lbnUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgIGlmIChldmVudC50YXJnZXQgPT09IGZ1bGxNZW51KSB7XHJcbiAgICAgIGNsb3NlTWVudS5jbGljaygpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICAkKCdbZGF0YS1za3JvbGxdJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICAgIGZ1bGxNZW51LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgfSk7XHJcbn0pKCk7XHJcbiIsIihmdW5jdGlvbiAoKSB7XHJcbiAgLy8gbW9kYWwgd2luZG93XHJcblxyXG4gIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI21vZGFsLXBvcHVwJykuaW5uZXJIVE1MO1xyXG4gIGNvbnN0IGJ0blJlYWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnRuX3Bob25lJyk7XHJcbiAgY29uc3QgYnRuUmVhZDIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnRuX25vbmUnKTtcclxuICBjb25zdCBjb21tZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbW1lbnRzX19zdG9yeScpO1xyXG5cclxuICBmb3IgKGkgPSAwOyBpIDwgYnRuUmVhZC5sZW5ndGg7IGkrKykge1xyXG4gICAgYnRuUmVhZFtpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgYmxvY2sgPSBjcmVhdGVCbG9jayhjb21tZW50LmlubmVySFRNTCk7XHJcbiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYmxvY2spO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBmb3IgKGkgPSAwOyBpIDwgYnRuUmVhZDIubGVuZ3RoOyBpKyspIHtcclxuICAgIGJ0blJlYWQyW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBjb25zdCBibG9jayA9IGNyZWF0ZUJsb2NrKGNvbW1lbnQuaW5uZXJIVE1MKTtcclxuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChibG9jayk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNyZWF0ZUJsb2NrKHRleHQpIHtcclxuICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgXHJcbiAgICBkaXYuY2xhc3NMaXN0LmFkZCgncG9wdXAnKTtcclxuICAgIGRpdi5pbm5lckhUTUwgPSBtb2RhbDtcclxuXHJcbiAgICBsZXQgcG9wTWVzcyA9IGRpdi5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX21lc3NhZ2UnKTtcclxuICAgIHBvcE1lc3MuaW5uZXJIVE1MID0gdGV4dDtcclxuXHJcbiAgICBjb25zdCBidG5DbG9zZSA9IGRpdi5xdWVyeVNlbGVjdG9yKCcuY2xvc2VfX3BvcHVwIC5jbG9zZV9fbGluaycpO1xyXG4gICAgYnRuQ2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZGl2KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRpdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgIGlmIChlLnRhcmdldCA9PT0gZGl2KSB7XHJcbiAgICAgICAgYnRuQ2xvc2UuY2xpY2soKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGRpdjtcclxuICB9XHJcblxyXG4gIC8vIHZhbGlkYXRlIGZvcm1cclxuXHJcbiAgY29uc3QgdmFsaWRUZWwgPSAvXigoOHxcXCs3KVtcXC0gXT8pPyhcXCg/XFxkezN9XFwpP1tcXC1dPyk/W1xcZFxcLSBdezcsMTB9JC87XHJcbiAgY29uc3QgdmFsaWROYW1lID0gL15b0LAt0Y/QkC3Qr117MiwzMH18W2EtekEtWl17MiwzMH0kLztcclxuICBjb25zdCB2YWxpZENvbW1lbnQgPSAvXlvQkC3Qr9CwLdGPMC05XFwgXFwuLCFcXD9cXC1AXSskLztcclxuICBjb25zdCBpc0Zvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZm9ybScpO1xyXG4gIGNvbnN0IHNlbmRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc2VuZEJ0bicpO1xyXG4gIHZhciB2YWxpZCA9IHRydWU7XHJcblxyXG4gIGZ1bmN0aW9uIGNyZWF0ZUVycm9yKG5laWdoYm9yLCBtZXNzYWdlKSB7XHJcbiAgICBuZWlnaGJvci5uZXh0RWxlbWVudFNpYmxpbmcuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICBuZWlnaGJvci5uZXh0RWxlbWVudFNpYmxpbmcudGV4dENvbnRlbnQgPSBtZXNzYWdlO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gcmVtb3ZlRXJyb3IobmVpZ2hib3IpIHtcclxuICAgIG5laWdoYm9yLm5leHRFbGVtZW50U2libGluZy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gdmFsaWRhdGVGb3JtKHZhbGlkKSB7XHJcbiAgICBcclxuICAgIGlmICghdmFsaWROYW1lLnRlc3QoaXNGb3JtLm5hbWUudmFsdWUpKSB7XHJcbiAgICAgIGNvbnN0IGVycm9yZU5hbWUgPSBcItCS0LLQtdC00LjRgtC1INCw0LTQtdC60LLQsNGC0L3QvtC1INC40LzRjy4g0J/RgNC40LzQtdGAOiDQodGC0LXQv9Cw0L0sIEJpbGx5LCDQmNC+0LPQsNC9LlwiO1xyXG4gICAgICBjcmVhdGVFcnJvcihpc0Zvcm0ubmFtZSwgZXJyb3JlTmFtZSk7XHJcbiAgICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZW1vdmVFcnJvcihpc0Zvcm0ubmFtZSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCF2YWxpZFRlbC50ZXN0KGlzRm9ybS5waG9uZS52YWx1ZSkpIHtcclxuICAgICAgY29uc3QgZXJyb3JlUGhvbmUgPSBcItCS0LLQtdC00LjRgtC1INCy0LXRgNC90YvQuSDQvdC+0LzQtdGAINGC0LXQu9C10YTQvtC90LAuINCf0YDQuNC80LXRgDogKzcgMTIzIDQ1NiA3OCA5MCwgMTIzNDU2Nzg5MC5cIjtcclxuICAgICAgY3JlYXRlRXJyb3IoaXNGb3JtLnBob25lLCBlcnJvcmVQaG9uZSk7XHJcbiAgICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZW1vdmVFcnJvcihpc0Zvcm0ucGhvbmUpO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICghdmFsaWRDb21tZW50LnRlc3QoaXNGb3JtLmNvbW1lbnQudmFsdWUpKSB7XHJcbiAgICAgIGNvbnN0IGVycm9yZVBob25lID0gXCLQktCy0LXQtNC40YLQtSDQutC+0LzQvNC10L3RgtCw0YDQuNC5LiDQndC1INCx0L7Qu9GM0YjQtSAxNTAg0YHQuNC80LLQvtC70L7Qsi4g0KDQsNC30YDQtdGI0LXQvdC+INGC0L7Qu9GM0LrQviDQutC40YDQuNC70LvQuNGG0LAsINGB0LjQvNCy0L7Qu9GLICEgLCAuID8gLSBALlwiO1xyXG4gICAgICBjcmVhdGVFcnJvcihpc0Zvcm0uY29tbWVudCwgZXJyb3JlUGhvbmUpO1xyXG4gICAgICB2YWxpZCA9IGZhbHNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVtb3ZlRXJyb3IoaXNGb3JtLmNvbW1lbnQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZhbGlkO1xyXG4gIH1cclxuXHJcbiAgaXNGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoKSA9PiB7IHZhbGlkYXRlRm9ybSh2YWxpZCk7IH0pO1xyXG5cclxuICBpc0Zvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIHZhbGlkYXRlRm9ybSh2YWxpZCk7XHJcblxyXG4gICAgaWYgKHZhbGlkYXRlRm9ybSh2YWxpZCkpIHtcclxuICAgICAgY29uc3QgZm9ybSA9IG5ldyBGb3JtRGF0YShpc0Zvcm0pO1xyXG5cclxuICAgICAgZm9ybS5hcHBlbmQoJ3RvJywgJ21haWxAbWFpbC5jb20nKTtcclxuICAgICAgY29uc3QgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICAgIHhoci5vcGVuKCdQT1NUJywgJ2h0dHBzOi8vd2ViZGV2LWFwaS5sb2Z0c2Nob29sLmNvbS9zZW5kbWFpbCcpO1xyXG4gICAgICB4aHIuc2VuZChmb3JtKTtcclxuICAgICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgYmxvY2sgPSBjcmVhdGVNb2RhbChKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpLm1lc3NhZ2UpO1xyXG4gICAgICAgIGlmICh4aHIuc3RhdHVzID49IDQwMCkge1xyXG4gICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCgn0KfRgtC+LdGC0L4g0YHQu9C+0LzQsNC70L7RgdGMLi4uJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYmxvY2spO1xyXG4gICAgICAgICAgZGVsZXRlTW9kdWwoYmxvY2spO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBzZW5kQnRuLmRpc2FibGVkID0gdHJ1ZTtcclxuXHJcbiAgICBzZXRUaW1lb3V0KCAoKSA9PiB7XHJcbiAgICAgIHNlbmRCdG4uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH0sIDMwMDApO1xyXG4gIH0pO1xyXG5cclxuICAvL2NyZWF0ZSBtb2RhbCBmb3IgZm9ybVxyXG5cclxuICBmdW5jdGlvbiBjcmVhdGVNb2RhbCh0ZXh0KSB7XHJcbiAgICBjb25zdCBkaXZGb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcblxyXG4gICAgZGl2Rm9ybS5jbGFzc0xpc3QuYWRkKCdwb3B1cCcpO1xyXG4gICAgZGl2Rm9ybS5pbm5lckhUTUwgPSBtb2RhbDtcclxuXHJcbiAgICBsZXQgcG9wTWVzcyA9IGRpdkZvcm0ucXVlcnlTZWxlY3RvcignLnBvcHVwX19tZXNzYWdlJyk7XHJcblxyXG4gICAgcG9wTWVzcy5pbm5lckhUTUwgPSB0ZXh0O1xyXG4gICAgZGl2Rm9ybS5maXJzdEVsZW1lbnRDaGlsZC5maXJzdEVsZW1lbnRDaGlsZC5yZW1vdmUoKTtcclxuICAgIGlucHV0LmNsYXNzTGlzdC5hZGQoJ2J0bicsICdidG5fbW9kYWwnKTtcclxuICAgIGlucHV0LnR5cGUgPSAnc3VibWl0JztcclxuICAgIGlucHV0LnZhbHVlID0gXCLQl9Cw0LrRgNGL0YLRjFwiO1xyXG4gICAgZGl2Rm9ybS5maXJzdEVsZW1lbnRDaGlsZC5hcHBlbmRDaGlsZChpbnB1dCk7XHJcbiAgICByZXR1cm4gZGl2Rm9ybTtcclxuICB9XHJcblxyXG4gIC8vcmVtb3ZlIG1vZHVsXHJcblxyXG4gIGZ1bmN0aW9uIGRlbGV0ZU1vZHVsKGVsZW0pIHtcclxuICAgIGNvbnN0IGNsb3NlQnRuTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnRuX21vZGFsJyk7XHJcblxyXG4gICAgY2xvc2VCdG5Nb2RhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlbGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xyXG5cclxuICAvL09uZVBhZ2VTY3JvbGxcclxuXHJcbiAgJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIHZhciBjb250YWluZXJTY3JvbGwgPSAkKCcud3JhcHBlcicpLFxyXG4gICAgICBzZWN0aW9uID0gJCgnLnNlY3Rpb24nKSxcclxuICAgICAgc2xpZGVyQ29udGFpbmVyID0gJCgnLm1haW5jb250YWluZXInKTtcclxuXHJcbiAgICBmdW5jdGlvbiBzY3JvbGwoaW5kZXhTZWN0aW9uLCBwb3NTZWN0aW9uKSB7XHJcbiAgICAgIHNsaWRlckNvbnRhaW5lci5hbmltYXRlKHtcclxuICAgICAgICAgICdib3R0b20nOiBpbmRleFNlY3Rpb24gKiAxMDAgKyAndmgnXHJcbiAgICAgICAgfSwgNzAwLFxyXG4gICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgIHBvc1NlY3Rpb247XHJcbiAgICAgICAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFjdGl2ZURvdChpbmRleCkge1xyXG4gICAgICAkKCcubmF2LXNlY3Rpb25zX19jaXJjbGUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJykuZXEoaW5kZXgpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBjb2xvckRvdChpbmRleFNlY3Rpb24pIHtcclxuICAgICAgaWYgKGluZGV4U2VjdGlvbiA9PSAxIHx8IGluZGV4U2VjdGlvbiA9PSA2IHx8IGluZGV4U2VjdGlvbiA9PSA4KSB7XHJcbiAgICAgICAgJCgnLm5hdi1zZWN0aW9uc19fcG9pbnQnKS5jc3MoJ2JhY2tncm91bmQtY29sb3InLCBcIiMyZjMyMzRcIik7XHJcbiAgICAgICAgJCgnLm5hdi1zZWN0aW9uc19fY2lyY2xlJykuY3NzKCdib3JkZXItY29sb3InLCBcInRyYW5zcGFyZW50XCIpO1xyXG4gICAgICAgICQoJy5uYXYtc2VjdGlvbnNfX2NpcmNsZS5hY3RpdmUnKS5jc3MoJ2JvcmRlci1jb2xvcicsIFwiIzJmMzIzNFwiKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAkKCcubmF2LXNlY3Rpb25zX19wb2ludCcpLmNzcygnYmFja2dyb3VuZC1jb2xvcicsIFwiI2ZmZlwiKTtcclxuICAgICAgICAkKCcubmF2LXNlY3Rpb25zX19jaXJjbGUnKS5jc3MoJ2JvcmRlci1jb2xvcicsIFwidHJhbnNwYXJlbnRcIik7XHJcbiAgICAgICAgJCgnLm5hdi1zZWN0aW9uc19fY2lyY2xlLmFjdGl2ZScpLmNzcygnYm9yZGVyLWNvbG9yJywgXCIjZmZmXCIpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gZnVsbFNjcmVlbigpIHtcclxuICAgICAgY29uc3QgZGl2VXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudXAnKTtcclxuXHJcbiAgICAgIGlmIChkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoIDwgNDgwKSB7XHJcbiAgICAgICAgaWYgKHNlY3Rpb25IZXJvLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykpIHtcclxuICAgICAgICAgIGNhbmNlbEZ1bGxTY3JlZW4uY2FsbChkb2N1bWVudCk7XHJcbiAgICAgICAgICBkaXZVcC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXF1ZXN0RnVsbFNjcmVlbi5jYWxsKGRvY3VtZW50LmJvZHkpO1xyXG4gICAgICAgICAgZGl2VXAuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGluc2Nyb2xsID0gZmFsc2U7XHJcblxyXG4gICAgY29udGFpbmVyU2Nyb2xsLm9uKCd3aGVlbCcsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICAgIHZhciBzZWN0aW9uQWN0ID0gc2VjdGlvbi5maWx0ZXIoJy5hY3RpdmUnKSxcclxuICAgICAgICBuZXh0U2VjdGlvbiA9IHNlY3Rpb25BY3QubmV4dCgpLFxyXG4gICAgICAgIHByZXZTZWN0aW9uID0gc2VjdGlvbkFjdC5wcmV2KCksXHJcbiAgICAgICAgaW5kZXhTZWN0aW9uLCBwb3NTZWN0aW9uO1xyXG5cclxuICAgICAgZnVuY3Rpb24gc2Nyb2xsV2hlZWwoaW5kZXhTZWN0aW9uLCBwb3NTZWN0aW9uKSB7XHJcbiAgICAgICAgc2xpZGVyQ29udGFpbmVyLmFuaW1hdGUoe1xyXG4gICAgICAgICAgICAnYm90dG9tJzogaW5kZXhTZWN0aW9uICogMTAwICsgJ3ZoJ1xyXG4gICAgICAgICAgfSwgNzAwLFxyXG4gICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBzZWN0aW9uQWN0LnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgcG9zU2VjdGlvblxyXG4gICAgICAgICAgICBjb2xvckRvdChpbmRleFNlY3Rpb24pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGluc2Nyb2xsID09PSBmYWxzZSkge1xyXG4gICAgICAgIGluc2Nyb2xsID0gdHJ1ZTtcclxuICAgICAgICBpZiAoZS5vcmlnaW5hbEV2ZW50LmRlbHRhWSA+IDApIHtcclxuICAgICAgICAgIGlmIChuZXh0U2VjdGlvbi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgaW5kZXhTZWN0aW9uID0gbmV4dFNlY3Rpb24uaW5kZXgoKTtcclxuICAgICAgICAgICAgcG9zU2VjdGlvbiA9IG5leHRTZWN0aW9uLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGluZGV4U2VjdGlvbiA9IHNlY3Rpb24uZmlyc3QoKS5pbmRleCgpO1xyXG4gICAgICAgICAgICBwb3NTZWN0aW9uID0gc2VjdGlvbi5maXJzdCgpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHNjcm9sbFdoZWVsKGluZGV4U2VjdGlvbiwgcG9zU2VjdGlvbik7XHJcbiAgICAgICAgICBhY3RpdmVEb3QoaW5kZXhTZWN0aW9uKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKHByZXZTZWN0aW9uLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBpbmRleFNlY3Rpb24gPSBwcmV2U2VjdGlvbi5pbmRleCgpO1xyXG4gICAgICAgICAgICBwb3NTZWN0aW9uID0gcHJldlNlY3Rpb24uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaW5kZXhTZWN0aW9uID0gc2VjdGlvbi5sYXN0KCkuaW5kZXgoKTtcclxuICAgICAgICAgICAgcG9zU2VjdGlvbiA9IHNlY3Rpb24ubGFzdCgpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHNjcm9sbFdoZWVsKGluZGV4U2VjdGlvbiwgcG9zU2VjdGlvbik7XHJcbiAgICAgICAgICBhY3RpdmVEb3QoaW5kZXhTZWN0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICBpbnNjcm9sbCA9IGZhbHNlO1xyXG4gICAgICAgIH0sIDE1MDApOyAvLyDQktGA0LXQvNGPINC90LAg0L7RgtC60LDRgiDRgdC+0LHRi9GC0LjRjyB3aGVlbFxyXG4gICAgICB9XHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgJCgnW2RhdGEtc2tyb2xsXScpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgaW5kZXhMaW5rID0gJCh0aGlzKS5hdHRyKCdkYXRhLXNrcm9sbCcpO1xyXG4gICAgICBzZWN0aW9uLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgY29uc3QgcG9zQWN0aXYgPSAkKCcuc2VjdGlvbicpLmVxKGluZGV4TGluaykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICBzY3JvbGwoaW5kZXhMaW5rLCBwb3NBY3Rpdik7XHJcbiAgICAgIGFjdGl2ZURvdChpbmRleExpbmspO1xyXG4gICAgICBjb2xvckRvdChpbmRleExpbmspO1xyXG4gICAgICBmdWxsU2NyZWVuKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiB0b3VjaEFuZEtleShrZXlDb2RlLCBkaXJlY3Rpb24pIHtcclxuICAgICAgbGV0IGltaXRhdGlvbkNsaWNrID0gJCgnLm5hdi1zZWN0aW9uc19fY2lyY2xlJykuZmlsdGVyKCcuYWN0aXZlJyk7XHJcblxyXG4gICAgICBpZiAoa2V5Q29kZSA9PSA0MCB8fCBkaXJlY3Rpb24gPT0gJ3VwJykge1xyXG4gICAgICAgIGltaXRhdGlvbkNsaWNrLm5leHQoKS5jbGljaygpO1xyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIGlmIChrZXlDb2RlID09IDM4IHx8IGRpcmVjdGlvbiA9PSAnZG93bicpIHtcclxuICAgICAgICBpbWl0YXRpb25DbGljay5wcmV2KCkuY2xpY2soKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICB2YXIgcmVxdWVzdEZ1bGxTY3JlZW4gPSBkb2N1bWVudC5ib2R5LnJlcXVlc3RGdWxsc2NyZWVuIHx8IGRvY3VtZW50LmJvZHkubW96UmVxdWVzdEZ1bGxTY3JlZW4gfHwgZG9jdW1lbnQuYm9keS53ZWJraXRSZXF1ZXN0RnVsbFNjcmVlbiB8fCBkb2N1bWVudC5ib2R5Lm1zUmVxdWVzdEZ1bGxzY3JlZW47XHJcbiAgICB2YXIgY2FuY2VsRnVsbFNjcmVlbiA9IGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuIHx8IGRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4gfHwgZG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW4gfHwgZG9jdW1lbnQubXNFeGl0RnVsbHNjcmVlbjtcclxuICAgIHZhciBtZCA9IG5ldyBNb2JpbGVEZXRlY3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG4gICAgY29uc3QgaXNNb2JpbGUgPSBtZC5tb2JpbGUoKTtcclxuICAgIGNvbnN0IHNlY3Rpb25IZXJvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlcm8nKTtcclxuICBcclxuICAgIGlmIChpc01vYmlsZSkge1xyXG4gICAgICAkKCcubWFpbmNvbnRhaW5lcicpLnN3aXBlKHtcclxuICAgICAgICBzd2lwZTogZnVuY3Rpb24gKGV2ZW50LCBkaXJlY3Rpb24pIHtcclxuICAgICAgICAgIHRvdWNoQW5kS2V5KCcnLCBkaXJlY3Rpb24pO1xyXG4gICAgICAgICAgZnVsbFNjcmVlbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgJChkb2N1bWVudCkub24oJ2tleWRvd24nLCAoZSkgPT4ge1xyXG4gICAgICBzd2l0Y2ggKGUua2V5Q29kZSkge1xyXG4gICAgICAgIGNhc2UgNDA6XHJcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICB0b3VjaEFuZEtleShlLmtleUNvZGUpO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAzODpcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgIHRvdWNoQW5kS2V5KGUua2V5Q29kZSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pKCk7IiwiY29uc3QgY29udGFpbmVyVmlkZW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX3BsYXllcicpLFxyXG4gIHZpZGVvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZGVvX19idXJnZXInKSxcclxuICBwbGF5ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX2NvbnRyb2xzJyksXHJcbiAgcGxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fc3RhcnQnKSxcclxuICB0cmFja0RvdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fdHJhY2stZG90JyksXHJcbiAgdHJhY2sgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX2xpbmUnKSxcclxuICB2b2x1bWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX3ZvbHVtZScpLFxyXG4gIHZvbHVtZVRyYWNrID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZGVvX192b2x1bWUtbGluZScpLFxyXG4gIHZvbHVtZURvdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fdm9sdW1lLWRvdCcpLFxyXG4gIHBsYXlTY3JlZW4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudmlkZW9fX3BsYXktc2NyZWVuJylcclxuXHJcblxyXG5mdW5jdGlvbiBkZWZhdWx0Vm9sdW1lKCkge1xyXG4gIGNvbnN0IHZvbCA9IHZpZGVvLnZvbHVtZSA9IDAuMjtcclxuICB2b2x1bWVEb3Quc3R5bGUubGVmdCA9IE1hdGguZmxvb3Iodm9sICogdm9sdW1lVHJhY2suY2xpZW50V2lkdGgpICsgJ3B4JztcclxufVxyXG5cclxuZnVuY3Rpb24gcGxheVBhdXNlKCkge1xyXG4gICh2aWRlby5wYXVzZWQpID8gdmlkZW8ucGxheSgpOiB2aWRlby5wYXVzZSgpO1xyXG4gIGNvbnRhaW5lclZpZGVvLmNsYXNzTGlzdC50b2dnbGUoJ3BhdXNlJyk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHRpbWVVcGRhdGUoKSB7XHJcbiAgY29uc3QgcHJvZ3Jlc3MgPSBNYXRoLmZsb29yKHZpZGVvLmN1cnJlbnRUaW1lKSAvIE1hdGguZmxvb3IodmlkZW8uZHVyYXRpb24pO1xyXG4gIHRyYWNrRG90LnN0eWxlLmxlZnQgPSBgJHtNYXRoLmZsb29yKHByb2dyZXNzICogdHJhY2suY2xpZW50V2lkdGgpfXB4YDtcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0Q3VycmVudFRpbWUoZSkge1xyXG4gIGNvbnN0IHggPSBlLm9mZnNldFggLyB0cmFjay5jbGllbnRXaWR0aDtcclxuICB2aWRlby5jdXJyZW50VGltZSA9IHggKiB2aWRlby5kdXJhdGlvbjtcclxufVxyXG5cclxuZnVuY3Rpb24gbXV0ZWQoZSkge1xyXG4gIGUuY3VycmVudFRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCdtdXRlJylcclxuICB2aWRlby5tdXRlZCA9ICF2aWRlby5tdXRlZDtcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0Vm9sdW1lKGUpIHtcclxuICB2b2x1bWVEb3Quc3R5bGUubGVmdCA9IGAke2Uub2Zmc2V0WH1weGA7XHJcbiAgdmlkZW8udm9sdW1lID0gZS5vZmZzZXRYIC8gZS5jdXJyZW50VGFyZ2V0LmNsaWVudFdpZHRoO1xyXG4gIHZpZGVvLnZvbHVtZSA9PT0gMCA/IHZvbHVtZS5jbGFzc0xpc3QuYWRkKCdtdXRlJyk6dm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoJ211dGUnKVxyXG59XHJcbnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ2NhbnBsYXl0aHJvdWdoJywgZnVuY3Rpb24gKCkge1xyXG4gIGRlZmF1bHRWb2x1bWUoKTtcclxufSk7XHJcbnBsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgcGxheVBhdXNlKClcclxufSk7XHJcbnBsYXlTY3JlZW4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XHJcbiAgcGxheVBhdXNlKClcclxufSk7XHJcbnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ3RpbWV1cGRhdGUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgdGltZVVwZGF0ZSgpO1xyXG59KTtcclxudHJhY2suYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG4gIHNldEN1cnJlbnRUaW1lKGUpO1xyXG59KTtcclxudm9sdW1lLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICBtdXRlZChlKTtcclxufSk7XHJcbnZvbHVtZVRyYWNrLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuICBzZXRWb2x1bWUoZSk7XHJcbn0pO1xyXG5cclxuXHJcbiIsIihmdW5jdGlvbigpe1xyXG5cclxuLy8gc2xpZGVyIGNvbnN0cnVjdG9yXHJcbmNsYXNzIFNsaWRlciB7XHJcbiAgY29uc3RydWN0b3Ioc2VsZWN0b3IpIHtcclxuICAgIHRoaXMuY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbiAgICB0aGlzLnNsaWRlciA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZXJfX2xpc3QnKTtcclxuICAgIHRoaXMuaXRlbSA9IHRoaXMuc2xpZGVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zbGlkZXJfX3NsaWQnKTtcclxuICAgIHRoaXMuYnRuTGVmdCA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZXJfX2J0bl9wcmV2Jyk7XHJcbiAgICB0aGlzLmJ0blJpZ2h0ID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNsaWRlcl9fYnRuX25leHQnKTtcclxuICAgIHRoaXMuY3VycmVudEl0ZW0gPSAwO1xyXG5cclxuICAgIHRoaXMuYnRuTGVmdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5zbGlkZXJHbygncHJldicpO1xyXG4gICAgfSlcclxuXHJcbiAgICB0aGlzLmJ0blJpZ2h0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLnNsaWRlckdvKCduZXh0Jyk7XHJcbiAgICB9KVxyXG4gIH1cclxuXHJcbiAgc2xpZGVyR28od2F5KSB7XHJcbiAgICBpZih3YXkgPT09ICduZXh0Jykge1xyXG4gICAgICB0aGlzLmN1cnJlbnRJdGVtKys7XHJcbiAgICB9XHJcblxyXG4gICAgaWYod2F5ID09PSAncHJldicpIHtcclxuICAgICAgdGhpcy5jdXJyZW50SXRlbS0tO1xyXG4gICAgfVxyXG5cclxuICAgIGlmKHRoaXMuY3VycmVudEl0ZW0gPT09IHRoaXMuaXRlbS5sZW5ndGgpIHtcclxuICAgICAgdGhpcy5jdXJyZW50SXRlbSA9IDA7XHJcbiAgICB9XHJcblxyXG4gICAgaWYodGhpcy5jdXJyZW50SXRlbSA8IDApIHtcclxuICAgICAgdGhpcy5jdXJyZW50SXRlbSA9IHRoaXMuaXRlbS5sZW5ndGgtMTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnRyYW5zbGF0ZSgpO1xyXG4gIH1cclxuXHJcbiAgdHJhbnNsYXRlKCkge1xyXG4gICAgdGhpcy5zbGlkZXIuc3R5bGUudHJhbnNmb3JtID0gYHRyYW5zbGF0ZVgoLSR7dGhpcy5jdXJyZW50SXRlbX0wMCUpYDtcclxuICB9XHJcbn1cclxuXHJcbm5ldyBTbGlkZXIoJy5zbGlkZXInKTtcclxuXHJcbi8vc2xpZGVyIChsaXRlIHZlcnNpb24pXHJcblxyXG4vLyBjb25zdCBzbGlkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVyZ2Vyc19fc2xpZGVyJyk7XHJcbi8vIGNvbnN0IGJ0blJpZ2h0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ1cmdlcnNfX3JpZ2h0Jyk7XHJcbi8vIGNvbnN0IGJ0bkxldGYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVyZ2Vyc19fbGVmdCcpXHJcbi8vIGNvbnN0IHNsaWRlckNoaWxkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmJ1cmdlcnNfX3NsaWRlci1pdGVtJyk7XHJcblxyXG5cclxuLy8gYnRuUmlnaHQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlPT57XHJcbi8vICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4vLyAgIHNsaWRlci5hcHBlbmRDaGlsZChzbGlkZXIuZmlyc3RFbGVtZW50Q2hpbGQpXHJcblxyXG4vLyB9KVxyXG5cclxuLy8gYnRuTGV0Zi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGU9PntcclxuLy8gICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbi8vICAgc2xpZGVyLmluc2VydEJlZm9yZShzbGlkZXIubGFzdEVsZW1lbnRDaGlsZCwgc2xpZGVyLmZpcnN0RWxlbWVudENoaWxkKVxyXG4vLyB9KVxyXG5cclxufSkoKTsiXX0=
